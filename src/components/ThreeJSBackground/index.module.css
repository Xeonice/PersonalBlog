.container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  /* 移动端动态视口高度支持 */
  height: 100vh;
  height: 100dvh; /* 动态视口高度，优先使用 */
  z-index: -1;
  pointer-events: none;
  overflow: hidden;
}

.canvas {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
}

.canvas canvas {
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  width: 100% !important;
  height: 100% !important;
  /* 确保平滑的主题过渡 */
  transition: opacity 0.3s ease;
  /* 防止 Canvas 被压缩或拉伸 */
  object-fit: cover;
  /* 优化滚动性能 */
  will-change: auto;
  /* 防止亚像素渲染问题 */
  image-rendering: -webkit-optimize-contrast;
  image-rendering: optimize-contrast;
}

/* 添加蒙层提高文字可读性 - 根据主题风格决定蒙层颜色 */
.container::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 1;
  transition: background-color 0.3s ease;
}

/* 深色主题蒙层 - 使用半透明黑色 */
.container.dark::after {
  background: rgba(0, 0, 0, 0.7);
}

/* 浅色主题蒙层 - 使用高透明度白色 */
.container.light::after {
  background: rgba(255, 255, 255, 0.9);
}

/* 优化移动端性能和滚动体验 */
@media (max-width: 768px) {
  .container {
    /* 使用 will-change 而不是 transform 来提示浏览器优化 */
    will-change: auto;
    /* 确保层叠上下文稳定 */
    isolation: isolate;
  }

  .canvas {
    /* 防止滚动时重新计算布局 */
    contain: layout style paint;
  }
}

/* 确保背景在所有主题下都正确显示 */
.container::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: var(--bg-primary);
  z-index: -1;
  transition: background-color 0.3s ease;
}

/* WebGL 不可用时的降级背景 */
.fallback {
  background: var(--bg-primary);
}

.fallbackGradient {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: radial-gradient(
    ellipse at center,
    var(--bg-secondary) 0%,
    var(--bg-primary) 100%
  );
  opacity: 0.6;
  animation: breathe 8s ease-in-out infinite;
}

@keyframes breathe {
  0%, 100% { opacity: 0.4; }
  50% { opacity: 0.7; }
}